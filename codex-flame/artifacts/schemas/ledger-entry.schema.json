{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Ceremonial Ledger Entry",
  "type": "object",
  "required": [
    "ledger_version",
    "dispatch_id", 
    "timestamp",
    "actor",
    "realm",
    "capsule",
    "intent",
    "governance"
  ],
  "properties": {
    "ledger_version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "description": "Version of the ledger format"
    },
    "dispatch_id": {
      "type": "string",
      "pattern": "^AXF-\\d{4}-\\d{2}-\\d{2}-\\d{4}$",
      "description": "Unique dispatch identifier"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp with Z suffix"
    },
    "actor": {
      "type": "string",
      "enum": ["Custodian", "Council", "Sentinel", "Architect", "Witness"],
      "description": "The entity performing the ceremony"
    },
    "realm": {
      "type": "string",
      "pattern": "^(Planetary|Stellar|Galactic|Universal):[A-Za-z0-9\\-]+$",
      "description": "Hierarchical realm identifier"
    },
    "capsule": {
      "type": "string",
      "description": "Ceremonial capsule type"
    },
    "intent": {
      "type": "string",
      "pattern": "^[A-Za-z]+(\\.[A-Za-z]+)*$",
      "description": "Dot-separated intent hierarchy"
    },
    "input": {
      "type": "object",
      "description": "Input parameters for the ceremony"
    },
    "output": {
      "type": "object",
      "description": "Results and outcomes of the ceremony"
    },
    "governance": {
      "type": "object",
      "required": ["seal", "audit_required"],
      "properties": {
        "seal": {
          "type": "string",
          "enum": ["Temporal", "Eternal", "Immutable", "Sacred"],
          "description": "Governance seal level"
        },
        "audit_required": {
          "type": "boolean",
          "description": "Whether audit trail is required"
        },
        "authority_level": {
          "type": "string",
          "enum": ["Low", "Medium", "High", "Critical"],
          "description": "Required authority level"
        }
      }
    },
    "links": {
      "type": "object",
      "properties": {
        "replay_ref": {
          "type": "string",
          "pattern": "^replays/[A-Za-z0-9\\-]+\\.json$"
        },
        "annal_ref": {
          "type": "string", 
          "pattern": "^annals/\\d{4}-\\d{2}\\.json$"
        },
        "parent_ceremony": {
          "type": "string",
          "description": "Reference to parent ceremony if this is a sub-ceremony"
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "priority": {
          "type": "string",
          "enum": ["Low", "Normal", "High", "Critical"]
        },
        "tags": {
          "type": "array",
          "items": {"type": "string"}
        },
        "expiration": {
          "type": "string",
          "format": "date-time",
          "description": "When this ceremony expires (if applicable)"
        }
      }
    }
  }
}